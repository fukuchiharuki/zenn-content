---
title: "ドメイン駆動設計"
emoji: "🎉"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: [ドメイン駆動設計, DDD]
published: false
---

ドメイン駆動設計に興味を持ったとき、私たちの前にはさまざまな設計パターンに関する情報が現れます。なかでも、「エンティティ」「値オブジェクト」「アグリゲート」「リポジトリ」といったパターンは明快で導入しやすいため、取り入れてみている人も多いことでしょう。

かつて私も、軽量DDDのような取り組みに惹かれ、“実装の形式を守ることこそがドメイン駆動設計だ”と信じていました。しかしいつからかこの姿勢に疑問をもつようになり、この問いと向き合っていく中で、設計の対象に対して**明確なメンタルモデルを持つこと**の方が、実はずっと大切なのだと気がつきました。

「私たちは、どのように世界を理解し、どのような物語を編むのか？」

本稿では、ドメイン駆動設計の本質を改めて見つめ直し、そこから最初の実践へと踏み出す第一歩を考えてみたいと思います。

## 第１章：誤解を紐解く

「エンティティ」「値オブジェクト」「アグリゲート」「リポジトリ」など、すぐに取り入れられそうに見えるそれらのパターンは、ドメイン駆動設計の入り口として親しまれてきました。しかし、その取り入れやすさは私たちの理解を行き詰まらせてしまうこともあります。

まずは、私たちが陥りやすい誤解や誤用──“できているつもりのドメイン駆動設計”について顧みてみようと思います。見過ごしてきた違和感に、向き合うことから始めていきましょう。

### 『エリック・エヴァンスのドメイン駆動設計』はパターンカタログ

ドメイン駆動設計という言葉を聞くとき、私たちはしばしば、設計パターンや設計技法に関する豊富な知識を思い浮かべます。その中には、ソフトウェアの複雑さに立ち向かうための実践的な考え方や手法が数多く含まれています。こうした知識は、ドメイン駆動設計を学び始めた人々にとって大きな魅力であり、しかしまた同時に、少し圧倒されるものでもあります。

実際、『エリック・エヴァンスのドメイン駆動設計』は、数多くのパターンとそれらの関係性を丁寧に書き綴った、まさに「設計とプロセスのパターン集」とも呼べる一冊です^[佐藤匡剛. “[ 技術講座 ] Domain-Driven Designのエッセンス 第1回”. オブジェクトの広場. 2007-07. https://www.ogis-ri.co.jp/otc/hiroba/technical/DDDEssence/chap1.html, (参照 2025-05-01).]。日本語訳の帯には「ユーザ要求の問題解決にフォーカスした設計パターン」と掲げられています。

それではまず、パターンとは何かについて、少し振り返ってみることにしましょう。

### パターン（パターン・ランゲージ）

ドメイン駆動設計に対する誤解を紐解いていくために、まずは「パターン」とは何かについて目を向けてみます。

パターンはもともと建築の分野で発展してきたものです。特に有名なのは、建築家クリストファー・アレグザンダーが提唱した「パターン・ランゲージ」という考え方です。そこでは、人々の暮らしや営みの中に繰り返し現れる「よいかたち」を見出だし、それを言語（ランゲージ）として共有することで、実践知やセンスを伝えようとしています^[CreativeShift. “パターン・ランゲージとは”. クリエイティブシフト. 2020-09-05. https://creativeshift.co.jp/pattern-lang/, (参照 2025-05-01).]。

ソフトウェア開発におけるパターンも同じです。**先人たちが典型的な設計をまとめた結果であり、それを再利用できる形にした知識**がパターンなのです^[鷲崎弘宜. ソフトウェアパターン概観. 情報処理, 情報処理学会. 2011, Vol.52, No.9, 1119-1126]。

ここで、パターンの意義を曖昧にすると、私たちは本来の意図とは異なるかたちでドメイン駆動設計を捉えてしまうかもしれません。次に、パターンの誤用について考えてみましょう。

:::message
これに対して、「アーキテクチャ」はどうでしょうか。

アーキテクチャもまた建築由来の言葉ですが、こちらは「全体がどうまとまっているか」に焦点を当てます。対象物を特徴づける様式のことで、材料・方法・フォームを含むスタイルであり、文化・思想・価値観を反映した表現でもあります。

パターンが「個々の局所的な問題の解決」であるのに対して、アーキテクチャは「全体の構造や骨格」あるいはその「文化的背景や思想」を指します。

ただし、全体の構造を問題にするとき、アーキテクチャもまたアーキテクチャパターン（典型的な骨格とその導出パターン）として扱われます。
:::

### パターンの誤用

パターン同士には、類似関係や利用関係といったつながりがありますが、その解決方針は文脈やフォース（その問題が発生してしまう理由やその解決を有効だと考える理由^[冨安慎吾. 国語科授業を取り巻く諸力についての研究─教育に関するパターンランゲージ群におけるフォース記述の分析を通して─. 全国大学国語教育学会国語科教育研究：大会研究発表要旨集. 2018, 135巻, 175-178.]）によって変わってきます。パターンの利用者、つまり読者である私たちは、その時々の状況に応じて、適切なパターンを選び、組み合わせて用いることが求められます。パターンとは、あらゆる場面で一律に適用できる「規則」ではなく、むしろ判断と理解を支える「思考の道具」なのです^[ryoasai. “日本でパターンが広まらない理由の一つは「ワンパターン」などのネガティブな和製英語のせい？”. 達人プログラマーを目指して. 2011-08-21. https://ryoasai.hatenadiary.org/entry/20110821/1313927820, (参照 2025-05-04).]。

「エンティティ」「値オブジェクト」「アグリゲート」「リポジトリ」などのパターンはそれ単体で導入しやすいこともあり、実装に取り入れている人（あるいはチーム）も多いことでしょう。私もかつては“エンティティやリポジトリを使えばそれだけでドメイン駆動設計になる”と考えていました。いわゆる軽量DDDと呼ばれる取り組みは、そうした実装レベルでのアプローチ──つまり、パターンを実装スタイルとして導入しようとする姿勢を指しているように思えます。

しかし、こんな経験はないでしょうか？

- アグリゲートを設けたものの、責務が曖昧で単なるデータコンテナになってしまった
- あるいは多様なユースケースに応じるため、逆に責務が大きくなり過ぎてしまった
- リポジトリは作ったが、データのマッピングの多さに悩まされている
- 値オブジェクトを導入したのに、結局はただのラップクラスにしかならなかった

多くの場合、こうしたつまずきの原因は“ドメインを理解しているつもり”で設計を進めてしまうことにあります。たとえ『エリック・エヴァンスのドメイン駆動設計』にあるパターンを導入したことで“それらしく整っている”ように見えたとしても、それが形式だけで成り立っているのであれば、その設計がドメインに根ざしているとは言えません。

パターンだけを実践しようとすることは、このような誤解そのものです。パターンがあくまで「手段」であり「目的」ではないことを、私たちは見失ってしまっていたのです。

では、その目的とは何なのでしょうか。ここで、そもそも「何を表現したかったのか？」というメンタルモデルが明確でなかったことに、改めて気づかされます。

:::message
ドメイン駆動設計に関する議論を眺めてみると、「イミュータブルな値オブジェクトにしなければならない」「集約はカプセル化されていなければならない」──のように技術的なプラクティスが強調されることが少なくありません。

軽量DDDやボトムアップDDDなど、戦術的設計と総称される設計パターンを重視する傾向は、日本で特に顕著であるように感じます。

英語圏の記事や議論を覗いてみると、「BC」という単語が頻繁に登場することからも、Bonded ContextやContext Mapなどが議論の中心に据えられている印象を受けます。
:::

## 第２章：真意を読み解く

ここからは、「ドメイン駆動設計」とは何なのか、そしてどのように実践へとつなげていけるのか、私なりの解釈を交えながら、その本質を捉え直してみたいと思います。

### ドメイン駆動設計

ドメイン駆動設計とは何か。この問いへの答えは、『エリック・エヴァンスのドメイン駆動設計』の「まえがき」にあります。

そこでは、「ドメイン駆動設計」とは、**ドメインモデリングと設計をどのように行うかを追求する哲学**であると述べられています^[エリック・エヴァンス. エリック・エヴァンスのドメイン駆動設計. 株式会社翔泳社, 2011, 576.]。つまり、ドメイン駆動設計とは単なる技法の集合ではなく、私たちがソフトウェアの設計において「何を大切にするのか」「どこに目を向けるのか」といった態度そのものに関わるものなのです。

### ドメインモデリングと設計の哲学

ここでいう哲学とは、ある問題の「本質」を明らかにすることで、その問題を解き明かすための「考え方」を見出だす営み──そう捉えるのがよいでしょう。

『エリック・エヴァンスのドメイン駆動設計』で語られる哲学とは、単なる設計技法の集まりではなく、設計そのものへの向き合い方を問うものです。それは、継続的な対話と探究の姿勢──すなわち、対話と新たな洞察を通じてモデルを育て、そのモデルをコードにおいて表現しようとする考え方です。

こうした姿勢は、設計や実装を単なる構築作業ではなく、コミュニケーションの一形態として捉え直すことにつながります。私たちがコードに表現しようとするモデルが、ドメインについて語るための言語となり、チームのコミュニケーションを豊かにしてくれる。それこそが、ドメイン駆動設計を実践するということなのです。

### ユビキタス言語とモデル駆動設計

---

見返し（表紙と裏表紙の内側に貼り付けられた色紙）にはこの本で述べられていることの全体像を表す図が描かれています。
この図に「ユビキタス言語」と「モデル駆動設計」が軸として据えられていることから、さらにこれらが最初に述べられるパターンであることからも、この本が対話と思考の枠組みを示そうとしている姿勢が伺えます。

---

1. 『エリック・エヴァンスのドメイン駆動設計』はパターン集
   - 原著が目指したもの
   - モデル駆動設計の重要性
   - なぜパターンに重点が置かれたのか
2. パターンとアーキテクチャの違い
   - グラデーション的な境界
   - 「パターン」は局所的な知恵、「アーキテクチャ」は全体の骨格
   - どう違う意識で扱うべきか
3. 軽量DDDはドメイン駆動設計ではない
   - パターンをなぞるだけではドメイン駆動にならない
   - メンタルモデルなき適用の危うさ
   - 「Lite」という言葉に潜む落とし穴
4. ドメイン駆動設計とは
   - モデルを中心に据える設計
   - ドメインに対する深い愛と理解
   - 設計者とドメインとの「対話」の重み
5. ドメイン駆動設計をLiteに実践する
   - モデル駆動を小さく始める試み
   - すべてを大仰にしない「静かなドメイン理解」
   - 仮説→試行→修正のサイクル
6. 一人で始めるドメイン駆動設計
   - メンタルモデルを持つ勇気
   - 仮説を外に出し、対話を重ねる
   - 一人でも、ドメインを愛する心を育てる
